{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'users/css/profile.css' %}">
<div class="profile-page-wrapper">

    <form method="POST" enctype="multipart/form-data" class="profile-edit-form">
        {% csrf_token %}

        <header class="page-header">
            <h2 class="page-title">Edit Profile</h2>
            <button type="submit" class="btn btn-save">
                Save Edit
            </button>
        </header>

        {% if u_form.errors or p_form.errors %}
        <div class="alert alert-error">
            <strong>แก้ไขข้อมูลไม่สำเร็จ กรุณาตรวจสอบ:</strong>
            <ul>
                {% for field, errors in u_form.errors.items %}
                <li>{{ field }}: {{ errors|join:", " }}</li>
                {% endfor %}
                {% for field, errors in p_form.errors.items %}
                <li>{{ field }}: {{ errors|join:", " }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <div class="profile-content-grid">

            <aside class="profile-sidebar">

                <div class="card upload-card">
                    <div class="image-preview-wrapper">
                        {% if user.profile.profile_image %}
                        <img src="{{ user.profile.profile_image.url }}" class="preview-img">
                        {% endif %}

                        <div class="upload-control-overlay">
                            {{ p_form.profile_image }}
                        </div>
                    </div>
                </div>

                <div class="card basic-info-card">
                    <div class="form-group">
                        <label class="form-label">Name (Display)</label>
                        <div class="form-input-wrapper">{{ p_form.displayName }}</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Student ID</label>
                        <div class="form-input-wrapper">{{ p_form.studentId }}</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Social Media</label>
                        <div class="form-input-wrapper">{{ p_form.socialMedia }}</div>
                    </div>
                </div>
            </aside>

            <section class="profile-main-content">

                <div class="card skills-card">
                    <h4 class="card-title">Skills</h4>
                    <div class="card-body">
                        {{ p_form.bioSkills }}
                    </div>
                </div>

                <div class="card info-card">
                    <h4 class="card-title">Information</h4>
                    <div class="info-form-list">

                        <div class="form-row">
                            <label class="form-label-inline">Phone :</label>
                            <div class="form-input-inline">{{ p_form.phoneNum }}</div>
                        </div>

                        <div class="form-row">
                            <label class="form-label-inline">Email :</label>
                            <div class="form-input-inline">{{ u_form.email }}</div>
                        </div>

                    </div>
                </div>

            </section>
        </div>
    </form>
</div>
{% endblock content %}